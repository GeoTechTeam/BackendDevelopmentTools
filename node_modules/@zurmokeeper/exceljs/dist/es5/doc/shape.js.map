{"version":3,"file":"shape.js","names":["colCache","require","Anchor","Shape","constructor","worksheet","model","type","shape","rotation","fill","stroke","hyperlinks","range","tl","br","ext","editAs","Error","_ref","decoded","decode","col","left","row","top","right","bottom","LINE","RECTANGLE","ROUND_RECTANGLE","ELLIPSE","TRIANGLE","RIGHT_ARROW","DOWN_ARROW","LEFT_BRACE","RIGHT_BRACE","module","exports"],"sources":["../../../lib/doc/shape.js"],"sourcesContent":["const colCache = require('../utils/col-cache');\r\nconst Anchor = require('./anchor');\r\n\r\nclass Shape {\r\n  constructor(worksheet, model) {\r\n    this.worksheet = worksheet;\r\n    this.model = model;\r\n  }\r\n\r\n  get model() {\r\n    switch (this.type) {\r\n      case 'shape':\r\n        return {\r\n          type: this.type,\r\n          shape: this.shape,\r\n          rotation: this.rotation,\r\n          fill: this.fill,\r\n          stroke: this.stroke,\r\n          hyperlinks: this.range.hyperlinks,\r\n          range: {\r\n            tl: this.range.tl.model,\r\n            br: this.range.br && this.range.br.model,\r\n            ext: this.range.ext,\r\n            editAs: this.range.editAs,\r\n          },\r\n        };\r\n      default:\r\n        throw new Error('Invalid Shape Type');\r\n    }\r\n  }\r\n\r\n  set model({type, shape, rotation, fill, stroke, range, hyperlinks}) {\r\n    this.type = type;\r\n    this.shape = shape;\r\n    this.rotation = rotation;\r\n    this.fill = fill;\r\n    this.stroke = stroke;\r\n\r\n    if (type === 'shape') {\r\n      if (typeof range === 'string') {\r\n        const decoded = colCache.decode(range);\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\r\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\r\n          editAs: 'oneCell',\r\n        };\r\n      } else {\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, range.tl, 0),\r\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\r\n          ext: range.ext,\r\n          editAs: range.editAs,\r\n          hyperlinks: hyperlinks || range.hyperlinks,\r\n        };\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nShape.LINE = 'line';\r\nShape.RECTANGLE = 'rect';\r\nShape.ROUND_RECTANGLE = 'roundRect';\r\nShape.ELLIPSE = 'ellipse';\r\nShape.TRIANGLE = 'triangle';\r\nShape.RIGHT_ARROW = 'rightArrow';\r\nShape.DOWN_ARROW = 'downArrow';\r\nShape.LEFT_BRACE = 'leftBrace';\r\nShape.RIGHT_BRACE = 'rightBrace';\r\n\r\nmodule.exports = Shape;\r\n"],"mappings":"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"}