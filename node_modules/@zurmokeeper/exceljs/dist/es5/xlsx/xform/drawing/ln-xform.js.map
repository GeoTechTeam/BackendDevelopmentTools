{"version":3,"file":"ln-xform.js","names":["BaseXform","require","SolidFillXform","NoFillXform","LnXform","constructor","model","map","tag","render","xmlStream","m","weight","opacity","openNode","w","closeNode","parseOpen","node","parser","name","parseInt","attributes","parseClose","undefined","Object","assign","keys","length","module","exports"],"sources":["../../../../../lib/xlsx/xform/drawing/ln-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\r\nconst SolidFillXform = require('./solid-fill-xform');\r\nconst NoFillXform = require('./no-fill-xform');\r\n\r\nclass LnXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n    this.model = null;\r\n    this.map = {\r\n      'a:solidFill': new SolidFillXform(),\r\n      'a:noFill': new NoFillXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'a:ln';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const m = typeof model !== 'object' || model === null ? {weight: 1, opacity: 0} : model;\r\n\r\n    xmlStream.openNode(this.tag, {w: (m.weight || 1) * 12700});\r\n    if (m.opacity === 0) {\r\n      this.map['a:noFill'].render(xmlStream, model);\r\n    } else {\r\n      this.map['a:solidFill'].render(xmlStream, model);\r\n    }\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          weight: parseInt(node.attributes.w || '12700', 10) / 12700,\r\n        };\r\n        break;\r\n      default:\r\n        this.parser = this.map[node.name];\r\n        if (this.parser) {\r\n          this.parser.parseOpen(node);\r\n        }\r\n        break;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    let model;\r\n    switch (name) {\r\n      case this.tag:\r\n        model = Object.assign({}, this.map['a:solidFill'].model, this.map['a:noFill'].model);\r\n        this.model = Object.keys(model).length ? Object.assign(this.model, model) : null;\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = LnXform;\r\n"],"mappings":"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"}