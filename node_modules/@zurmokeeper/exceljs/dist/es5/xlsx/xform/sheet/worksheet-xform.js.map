{"version":3,"file":"worksheet-xform.js","names":["_","require","colCache","XmlStream","RelType","Merges","BaseXform","ListXform","RowXform","ColXform","DimensionXform","HyperlinkXform","MergeCellXform","DataValidationsXform","SheetPropertiesXform","SheetFormatPropertiesXform","SheetViewXform","SheetProtectionXform","PageMarginsXform","PageSetupXform","PrintOptionsXform","AutoFilterXform","PictureXform","DrawingXform","TablePartXform","RowBreaksXform","ColBreaksXform","HeaderFooterXform","ConditionalFormattingsXform","ExtListXform","mergeRule","rule","extRule","Object","keys","forEach","key","value","extValue","undefined","mergeConditionalFormattings","model","extModel","length","cfMap","ruleMap","cf","ref","rules","x14Id","extCf","push","WorkSheetXform","constructor","options","maxRows","maxCols","ignoreNodes","map","sheetPr","dimension","sheetViews","tag","count","childXform","sheetFormatPr","cols","sheetData","empty","maxItems","autoFilter","mergeCells","rowBreaks","colBreaks","hyperlinks","pageMargins","dataValidations","pageSetup","headerFooter","printOptions","picture","drawing","sheetProtection","tableParts","conditionalFormatting","extLst","prepare","merges","comments","formulae","siFormulae","rows","conditionalFormattings","rels","nextRid","r","concat","isInternalLink","m","target","slice","hyperlink","rId","Id","Type","Hyperlink","Target","TargetMode","comment","Comments","id","vmlDrawing","VmlDrawing","item","refAddress","decodeAddress","commentRefs","commentName","drawingRelsHash","bookImage","media","medium","type","imageId","Image","name","extension","background","image","drawingsCount","anchors","drawings","rIdImage","preImageId","anchor","range","rIdHyperLink","tooltip","tables","table","Table","columns","column","style","dxfId","styles","addDxfStyle","render","xmlStream","openXml","StdDocAttributes","openNode","WORKSHEET_ATTRIBUTES","sheetFormatPropertiesModel","properties","defaultRowHeight","dyDescent","outlineLevelCol","outlineLevelRow","defaultColWidth","sheetPropertiesModel","outlineProperties","tabColor","fitToPage","pageMarginsModel","margins","printOptionsModel","showRowColHeaders","showGridLines","horizontalCentered","verticalCentered","sheetProtectionModel","dimensions","views","rel","leafNode","closeNode","parseOpen","node","parser","each","xform","reset","includes","parseText","text","parseClose","sheetProperties","assign","reconcile","relationships","reduce","h","vmlComment","vmlDrawings","index","note","commentsMap","hyperlinkMap","address","filter","Boolean","row","cells","drawingRel","match","drawingName","backgroundRel","split","mediaIndex","tablePart","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/worksheet-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\r\n\r\nconst colCache = require('../../../utils/col-cache');\r\nconst XmlStream = require('../../../utils/xml-stream');\r\n\r\nconst RelType = require('../../rel-type');\r\n\r\nconst Merges = require('./merges');\r\n\r\nconst BaseXform = require('../base-xform');\r\nconst ListXform = require('../list-xform');\r\nconst RowXform = require('./row-xform');\r\nconst ColXform = require('./col-xform');\r\nconst DimensionXform = require('./dimension-xform');\r\nconst HyperlinkXform = require('./hyperlink-xform');\r\nconst MergeCellXform = require('./merge-cell-xform');\r\nconst DataValidationsXform = require('./data-validations-xform');\r\nconst SheetPropertiesXform = require('./sheet-properties-xform');\r\nconst SheetFormatPropertiesXform = require('./sheet-format-properties-xform');\r\nconst SheetViewXform = require('./sheet-view-xform');\r\nconst SheetProtectionXform = require('./sheet-protection-xform');\r\nconst PageMarginsXform = require('./page-margins-xform');\r\nconst PageSetupXform = require('./page-setup-xform');\r\nconst PrintOptionsXform = require('./print-options-xform');\r\nconst AutoFilterXform = require('./auto-filter-xform');\r\nconst PictureXform = require('./picture-xform');\r\nconst DrawingXform = require('./drawing-xform');\r\nconst TablePartXform = require('./table-part-xform');\r\nconst RowBreaksXform = require('./row-breaks-xform');\r\nconst ColBreaksXform = require('./col-breaks-xform');\r\nconst HeaderFooterXform = require('./header-footer-xform');\r\nconst ConditionalFormattingsXform = require('./cf/conditional-formattings-xform');\r\nconst ExtListXform = require('./ext-lst-xform');\r\n\r\nconst mergeRule = (rule, extRule) => {\r\n  Object.keys(extRule).forEach(key => {\r\n    const value = rule[key];\r\n    const extValue = extRule[key];\r\n    if (value === undefined && extValue !== undefined) {\r\n      rule[key] = extValue;\r\n    }\r\n  });\r\n};\r\n\r\nconst mergeConditionalFormattings = (model, extModel) => {\r\n  // conditional formattings are rendered in worksheet.conditionalFormatting and also in\r\n  // worksheet.extLst.ext.x14:conditionalFormattings\r\n  // some (e.g. dataBar) are even spread across both!\r\n  if (!extModel || !extModel.length) {\r\n    return model;\r\n  }\r\n  if (!model || !model.length) {\r\n    return extModel;\r\n  }\r\n\r\n  // index model rules by x14Id\r\n  const cfMap = {};\r\n  const ruleMap = {};\r\n  model.forEach(cf => {\r\n    cfMap[cf.ref] = cf;\r\n    cf.rules.forEach(rule => {\r\n      const {x14Id} = rule;\r\n      if (x14Id) {\r\n        ruleMap[x14Id] = rule;\r\n      }\r\n    });\r\n  });\r\n\r\n  extModel.forEach(extCf => {\r\n    extCf.rules.forEach(extRule => {\r\n      const rule = ruleMap[extRule.x14Id];\r\n      if (rule) {\r\n        // merge with matching rule\r\n        mergeRule(rule, extRule);\r\n      } else if (cfMap[extCf.ref]) {\r\n        // reuse existing cf ref\r\n        cfMap[extCf.ref].rules.push(extRule);\r\n      } else {\r\n        // create new cf\r\n        model.push({\r\n          ref: extCf.ref,\r\n          rules: [extRule],\r\n        });\r\n      }\r\n    });\r\n  });\r\n\r\n  // need to cope with rules in extModel that don't exist in model\r\n  return model;\r\n};\r\n\r\nclass WorkSheetXform extends BaseXform {\r\n  constructor(options) {\r\n    super();\r\n\r\n    const {maxRows, maxCols, ignoreNodes} = options || {};\r\n    this.ignoreNodes = ignoreNodes || [];\r\n    this.map = {\r\n      sheetPr: new SheetPropertiesXform(),\r\n      dimension: new DimensionXform(),\r\n      sheetViews: new ListXform({\r\n        tag: 'sheetViews',\r\n        count: false,\r\n        childXform: new SheetViewXform(),\r\n      }),\r\n      sheetFormatPr: new SheetFormatPropertiesXform(),\r\n      cols: new ListXform({tag: 'cols', count: false, childXform: new ColXform()}),\r\n      sheetData: new ListXform({\r\n        tag: 'sheetData',\r\n        count: false,\r\n        empty: true,\r\n        childXform: new RowXform({maxItems: maxCols}),\r\n        maxItems: maxRows,\r\n      }),\r\n      autoFilter: new AutoFilterXform(),\r\n      mergeCells: new ListXform({tag: 'mergeCells', count: true, childXform: new MergeCellXform()}),\r\n      rowBreaks: new RowBreaksXform(),\r\n      colBreaks: new ColBreaksXform(),\r\n      hyperlinks: new ListXform({\r\n        tag: 'hyperlinks',\r\n        count: false,\r\n        childXform: new HyperlinkXform(),\r\n      }),\r\n      pageMargins: new PageMarginsXform(),\r\n      dataValidations: new DataValidationsXform(),\r\n      pageSetup: new PageSetupXform(),\r\n      headerFooter: new HeaderFooterXform(),\r\n      printOptions: new PrintOptionsXform(),\r\n      picture: new PictureXform(),\r\n      drawing: new DrawingXform(),\r\n      sheetProtection: new SheetProtectionXform(),\r\n      tableParts: new ListXform({tag: 'tableParts', count: true, childXform: new TablePartXform()}),\r\n      conditionalFormatting: new ConditionalFormattingsXform(),\r\n      extLst: new ExtListXform(),\r\n    };\r\n  }\r\n\r\n  prepare(model, options) {\r\n    options.merges = new Merges();\r\n    model.hyperlinks = options.hyperlinks = [];\r\n    model.comments = options.comments = [];\r\n\r\n    options.formulae = {};\r\n    options.siFormulae = 0;\r\n    this.map.cols.prepare(model.cols, options);\r\n    this.map.sheetData.prepare(model.rows, options);\r\n    this.map.conditionalFormatting.prepare(model.conditionalFormattings, options);\r\n\r\n    model.mergeCells = options.merges.mergeCells;\r\n\r\n    // prepare relationships\r\n    const rels = (model.rels = []);\r\n\r\n    function nextRid(r) {\r\n      return `rId${r.length + 1}`;\r\n    }\r\n\r\n    // TODO: The same as HyperlinkXform. isInternalLink\r\n    function isInternalLink(m) {\r\n      return m.target && m.target.slice(0, 1) === '#';\r\n    }\r\n\r\n    model.hyperlinks.forEach(hyperlink => {\r\n      const rId = nextRid(rels);\r\n      hyperlink.rId = rId;\r\n      // Internal hyperlink do not need to generate worksheets/_rels/sheetx.xml.rels, but external hyperlink do.\r\n      if (!isInternalLink(hyperlink)) {\r\n        rels.push({\r\n          Id: rId,\r\n          Type: RelType.Hyperlink,\r\n          Target: hyperlink.target,\r\n          TargetMode: 'External',\r\n        });\r\n      }\r\n    });\r\n\r\n    // prepare comment relationships\r\n    if (model.comments.length > 0) {\r\n      const comment = {\r\n        Id: nextRid(rels),\r\n        Type: RelType.Comments,\r\n        Target: `../comments${model.id}.xml`,\r\n      };\r\n      rels.push(comment);\r\n      const vmlDrawing = {\r\n        Id: nextRid(rels),\r\n        Type: RelType.VmlDrawing,\r\n        Target: `../drawings/vmlDrawing${model.id}.vml`,\r\n      };\r\n      rels.push(vmlDrawing);\r\n\r\n      model.comments.forEach(item => {\r\n        item.refAddress = colCache.decodeAddress(item.ref);\r\n      });\r\n\r\n      options.commentRefs.push({\r\n        commentName: `comments${model.id}`,\r\n        vmlDrawing: `vmlDrawing${model.id}`,\r\n      });\r\n    }\r\n\r\n    const drawingRelsHash = [];\r\n    let bookImage;\r\n    model.media.forEach(medium => {\r\n      if (medium.type === 'background') {\r\n        const rId = nextRid(rels);\r\n        bookImage = options.media[medium.imageId];\r\n        rels.push({\r\n          Id: rId,\r\n          Type: RelType.Image,\r\n          Target: `../media/${bookImage.name}.${bookImage.extension}`,\r\n        });\r\n        model.background = {\r\n          rId,\r\n        };\r\n        model.image = options.media[medium.imageId];\r\n      } else if (medium.type === 'image') {\r\n        let {drawing} = model;\r\n        bookImage = options.media[medium.imageId];\r\n        if (!drawing) {\r\n          drawing = model.drawing = {\r\n            rId: nextRid(rels),\r\n            name: `drawing${++options.drawingsCount}`,\r\n            anchors: [],\r\n            rels: [],\r\n          };\r\n          options.drawings.push(drawing);\r\n          rels.push({\r\n            Id: drawing.rId,\r\n            Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing',\r\n            Target: `../drawings/${drawing.name}.xml`,\r\n          });\r\n        }\r\n        let rIdImage =\r\n          this.preImageId === medium.imageId ? drawingRelsHash[medium.imageId] : drawingRelsHash[drawing.rels.length];\r\n        if (!rIdImage) {\r\n          rIdImage = nextRid(drawing.rels);\r\n          drawingRelsHash[drawing.rels.length] = rIdImage;\r\n          drawing.rels.push({\r\n            Id: rIdImage,\r\n            Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\r\n            Target: `../media/${bookImage.name}.${bookImage.extension}`,\r\n          });\r\n        }\r\n\r\n        const anchor = {\r\n          picture: {\r\n            rId: rIdImage,\r\n          },\r\n          range: medium.range,\r\n        };\r\n        if (medium.hyperlinks && medium.hyperlinks.hyperlink) {\r\n          const rIdHyperLink = nextRid(drawing.rels);\r\n          drawingRelsHash[drawing.rels.length] = rIdHyperLink;\r\n          anchor.picture.hyperlinks = {\r\n            tooltip: medium.hyperlinks.tooltip,\r\n            rId: rIdHyperLink,\r\n          };\r\n          drawing.rels.push({\r\n            Id: rIdHyperLink,\r\n            Type: RelType.Hyperlink,\r\n            Target: medium.hyperlinks.hyperlink,\r\n            TargetMode: 'External',\r\n          });\r\n        }\r\n        this.preImageId = medium.imageId;\r\n        drawing.anchors.push(anchor);\r\n      }\r\n    });\r\n\r\n    // prepare tables\r\n    model.tables.forEach(table => {\r\n      // relationships\r\n      const rId = nextRid(rels);\r\n      table.rId = rId;\r\n      rels.push({\r\n        Id: rId,\r\n        Type: RelType.Table,\r\n        Target: `../tables/${table.target}`,\r\n      });\r\n\r\n      // dynamic styles\r\n      table.columns.forEach(column => {\r\n        const {style} = column;\r\n        if (style) {\r\n          column.dxfId = options.styles.addDxfStyle(style);\r\n        }\r\n      });\r\n    });\r\n\r\n    // prepare ext items\r\n    this.map.extLst.prepare(model, options);\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openXml(XmlStream.StdDocAttributes);\r\n    xmlStream.openNode('worksheet', WorkSheetXform.WORKSHEET_ATTRIBUTES);\r\n\r\n    const sheetFormatPropertiesModel = model.properties\r\n      ? {\r\n          defaultRowHeight: model.properties.defaultRowHeight,\r\n          dyDescent: model.properties.dyDescent,\r\n          outlineLevelCol: model.properties.outlineLevelCol,\r\n          outlineLevelRow: model.properties.outlineLevelRow,\r\n        }\r\n      : undefined;\r\n    if (model.properties && model.properties.defaultColWidth) {\r\n      sheetFormatPropertiesModel.defaultColWidth = model.properties.defaultColWidth;\r\n    }\r\n    const sheetPropertiesModel = {\r\n      outlineProperties: model.properties && model.properties.outlineProperties,\r\n      tabColor: model.properties && model.properties.tabColor,\r\n      pageSetup:\r\n        model.pageSetup && model.pageSetup.fitToPage\r\n          ? {\r\n              fitToPage: model.pageSetup.fitToPage,\r\n            }\r\n          : undefined,\r\n    };\r\n    const pageMarginsModel = model.pageSetup && model.pageSetup.margins;\r\n    const printOptionsModel = {\r\n      showRowColHeaders: model.pageSetup && model.pageSetup.showRowColHeaders,\r\n      showGridLines: model.pageSetup && model.pageSetup.showGridLines,\r\n      horizontalCentered: model.pageSetup && model.pageSetup.horizontalCentered,\r\n      verticalCentered: model.pageSetup && model.pageSetup.verticalCentered,\r\n    };\r\n    const sheetProtectionModel = model.sheetProtection;\r\n\r\n    this.map.sheetPr.render(xmlStream, sheetPropertiesModel);\r\n    this.map.dimension.render(xmlStream, model.dimensions);\r\n    this.map.sheetViews.render(xmlStream, model.views);\r\n    this.map.sheetFormatPr.render(xmlStream, sheetFormatPropertiesModel);\r\n    this.map.cols.render(xmlStream, model.cols);\r\n    this.map.sheetData.render(xmlStream, model.rows);\r\n    this.map.sheetProtection.render(xmlStream, sheetProtectionModel); // Note: must be after sheetData and before autoFilter\r\n    this.map.autoFilter.render(xmlStream, model.autoFilter);\r\n    this.map.mergeCells.render(xmlStream, model.mergeCells);\r\n    this.map.conditionalFormatting.render(xmlStream, model.conditionalFormattings); // Note: must be before dataValidations\r\n    this.map.dataValidations.render(xmlStream, model.dataValidations);\r\n\r\n    // For some reason hyperlinks have to be after the data validations\r\n    this.map.hyperlinks.render(xmlStream, model.hyperlinks);\r\n\r\n    this.map.printOptions.render(xmlStream, printOptionsModel); // Note: must be before pageMargins\r\n    this.map.pageMargins.render(xmlStream, pageMarginsModel);\r\n    this.map.pageSetup.render(xmlStream, model.pageSetup);\r\n    this.map.headerFooter.render(xmlStream, model.headerFooter);\r\n    this.map.rowBreaks.render(xmlStream, model.rowBreaks);\r\n    this.map.colBreaks.render(xmlStream, model.colBreaks);\r\n    this.map.drawing.render(xmlStream, model.drawing); // Note: must be after rowBreaks\r\n    this.map.picture.render(xmlStream, model.background); // Note: must be after drawing\r\n    this.map.tableParts.render(xmlStream, model.tables);\r\n\r\n    this.map.extLst.render(xmlStream, model);\r\n\r\n    if (model.rels) {\r\n      // add a <legacyDrawing /> node for each comment\r\n      model.rels.forEach(rel => {\r\n        if (rel.Type === RelType.VmlDrawing) {\r\n          xmlStream.leafNode('legacyDrawing', {'r:id': rel.Id});\r\n        }\r\n      });\r\n    }\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n\r\n    if (node.name === 'worksheet') {\r\n      _.each(this.map, xform => {\r\n        xform.reset();\r\n      });\r\n      return true;\r\n    }\r\n\r\n    if (this.map[node.name] && !this.ignoreNodes.includes(node.name)) {\r\n      this.parser = this.map[node.name];\r\n      this.parser.parseOpen(node);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case 'worksheet': {\r\n        const properties = this.map.sheetFormatPr.model || {};\r\n        if (this.map.sheetPr.model && this.map.sheetPr.model.tabColor) {\r\n          properties.tabColor = this.map.sheetPr.model.tabColor;\r\n        }\r\n        if (this.map.sheetPr.model && this.map.sheetPr.model.outlineProperties) {\r\n          properties.outlineProperties = this.map.sheetPr.model.outlineProperties;\r\n        }\r\n        const sheetProperties = {\r\n          fitToPage:\r\n            (this.map.sheetPr.model &&\r\n              this.map.sheetPr.model.pageSetup &&\r\n              this.map.sheetPr.model.pageSetup.fitToPage) ||\r\n            false,\r\n          margins: this.map.pageMargins.model,\r\n        };\r\n        const pageSetup = Object.assign(sheetProperties, this.map.pageSetup.model, this.map.printOptions.model);\r\n        const conditionalFormattings = mergeConditionalFormattings(\r\n          this.map.conditionalFormatting.model,\r\n          this.map.extLst.model && this.map.extLst.model['x14:conditionalFormattings']\r\n        );\r\n        this.model = {\r\n          dimensions: this.map.dimension.model,\r\n          cols: this.map.cols.model,\r\n          rows: this.map.sheetData.model,\r\n          mergeCells: this.map.mergeCells.model,\r\n          hyperlinks: this.map.hyperlinks.model,\r\n          dataValidations: this.map.dataValidations.model,\r\n          properties,\r\n          views: this.map.sheetViews.model,\r\n          pageSetup,\r\n          headerFooter: this.map.headerFooter.model,\r\n          background: this.map.picture.model,\r\n          drawing: this.map.drawing.model,\r\n          tables: this.map.tableParts.model,\r\n          conditionalFormattings,\r\n        };\r\n\r\n        if (this.map.autoFilter.model) {\r\n          this.model.autoFilter = this.map.autoFilter.model;\r\n        }\r\n        if (this.map.sheetProtection.model) {\r\n          this.model.sheetProtection = this.map.sheetProtection.model;\r\n        }\r\n\r\n        return false;\r\n      }\r\n\r\n      default:\r\n        // not quite sure how we get here!\r\n        return true;\r\n    }\r\n  }\r\n\r\n  reconcile(model, options) {\r\n    // options.merges = new Merges();\r\n    // options.merges.reconcile(model.mergeCells, model.rows);\r\n    const rels = (model.relationships || []).reduce((h, rel) => {\r\n      h[rel.Id] = rel;\r\n      if (rel.Type === RelType.Comments) {\r\n        model.comments = options.comments[rel.Target].comments;\r\n      }\r\n      if (rel.Type === RelType.VmlDrawing && model.comments && model.comments.length) {\r\n        const vmlComment = options.vmlDrawings[rel.Target].comments;\r\n        model.comments.forEach((comment, index) => {\r\n          comment.note = Object.assign({}, comment.note, vmlComment[index]);\r\n        });\r\n      }\r\n      return h;\r\n    }, {});\r\n    options.commentsMap = (model.comments || []).reduce((h, comment) => {\r\n      if (comment.ref) {\r\n        h[comment.ref] = comment;\r\n      }\r\n      return h;\r\n    }, {});\r\n    options.hyperlinkMap = (model.hyperlinks || []).reduce((h, hyperlink) => {\r\n      if (hyperlink.rId) {\r\n        h[hyperlink.address] = rels[hyperlink.rId].Target;\r\n      }\r\n      return h;\r\n    }, {});\r\n    options.formulae = {};\r\n\r\n    // compact the rows and cells\r\n    model.rows = (model.rows && model.rows.filter(Boolean)) || [];\r\n    model.rows.forEach(row => {\r\n      row.cells = (row.cells && row.cells.filter(Boolean)) || [];\r\n    });\r\n\r\n    this.map.cols.reconcile(model.cols, options);\r\n    this.map.sheetData.reconcile(model.rows, options);\r\n    this.map.conditionalFormatting.reconcile(model.conditionalFormattings, options);\r\n\r\n    model.media = [];\r\n    if (model.drawing) {\r\n      const drawingRel = rels[model.drawing.rId];\r\n      const match = drawingRel.Target.match(/\\/drawings\\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);\r\n      if (match) {\r\n        const drawingName = match[1];\r\n        const drawing = options.drawings[drawingName];\r\n        drawing.anchors.forEach(anchor => {\r\n          if (anchor.medium) {\r\n            const image = {\r\n              type: 'image',\r\n              imageId: anchor.medium.index,\r\n              range: anchor.range,\r\n              hyperlinks: anchor.picture.hyperlinks,\r\n            };\r\n            model.media.push(image);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    const backgroundRel = model.background && rels[model.background.rId];\r\n    if (backgroundRel) {\r\n      const target = backgroundRel.Target.split('/media/')[1];\r\n      const imageId = options.mediaIndex && options.mediaIndex[target];\r\n      if (imageId !== undefined) {\r\n        model.media.push({\r\n          type: 'background',\r\n          imageId,\r\n        });\r\n      }\r\n    }\r\n\r\n    model.tables = (model.tables || []).map(tablePart => {\r\n      const rel = rels[tablePart.rId];\r\n      return options.tables[rel.Target];\r\n    });\r\n\r\n    delete model.relationships;\r\n    delete model.hyperlinks;\r\n    delete model.comments;\r\n  }\r\n}\r\n\r\nWorkSheetXform.WORKSHEET_ATTRIBUTES = {\r\n  xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\r\n  'xmlns:r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\r\n  'xmlns:mc': 'http://schemas.openxmlformats.org/markup-compatibility/2006',\r\n  'mc:Ignorable': 'x14ac',\r\n  'xmlns:x14ac': 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac',\r\n};\r\n\r\nmodule.exports = WorkSheetXform;\r\n"],"mappings":"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"}